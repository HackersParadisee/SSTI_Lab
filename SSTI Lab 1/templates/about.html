<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>About - SSTI Explanation</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css">
</head>
<body class="bg-gray-900 text-white">
    <nav class="bg-gray-800 p-4 shadow-lg">
        <div class="container mx-auto flex justify-between items-center">
            <a href="/" class="text-2xl font-bold text-cyan-400">MrWebSecure</a>
            <div>
                <a href="/" class="mr-6 text-gray-300 hover:text-white">Home</a>
                <a href="/about" class="text-gray-300 hover:text-white">About SSTI</a>
            </div>
        </div>
    </nav>

    <div class="container mx-auto p-6 mt-4 space-y-6">

        <div class="bg-gray-800 p-6 rounded-lg shadow-lg">
            <h2 class="text-3xl font-bold text-cyan-400 mb-4">What is SSTI?</h2>
            <p>Server-Side Template Injection (SSTI) occurs when user inputs are rendered on the server-side without proper sanitization or validation. This leads to the execution of unintended commands, allowing attackers to perform various malicious actions.</p>
        </div>

        <div class="bg-gray-800 p-6 rounded-lg shadow-lg">
            <h2 class="text-3xl font-bold text-cyan-400 mb-4">How Does it Occur?</h2>
            <p>It happens when user inputs are directly rendered through template engines like Jinja2 without adequate validation. When the template engine processes malicious code, it executes it on the server-side.</p>
        </div>

        <div class="bg-gray-800 p-6 rounded-lg shadow-lg">
            <h2 class="text-3xl font-bold text-cyan-400 mb-4">How is it Exploited?</h2>
            <ul class="list-disc ml-6 space-y-2">
                <li>Injecting malicious payloads into fields processed by the template engine.</li>
                <li>Accessing server files or executing commands via template expressions.</li>
                <li>RCE (Remote Code Execution) through improperly handled inputs.</li>
            </ul>
        </div>

        <div class="bg-gray-800 p-6 rounded-lg shadow-lg">
            <h2 class="text-3xl font-bold text-cyan-400 mb-4">Examples of Payloads</h2>
            <ul class="list-disc ml-6 space-y-2">
                <li><code>{{7*7}}</code> - Simple arithmetic check</li>
                <li><code>{{config.items()}}</code> - Dumping configuration items</li>
                <li><code>{{self._TemplateReference__context.cycler.__init__.__globals__.os.popen('whoami').read()}}</code> - Executing commands</li>
            </ul>
        </div>

        <div class="bg-gray-800 p-6 rounded-lg shadow-lg">
            <h2 class="text-3xl font-bold text-cyan-400 mb-4">What is the Risk and How Can it Affect?</h2>
            <p>SSTI can lead to:</p>
            <ul class="list-disc ml-6 space-y-2">
                <li>Remote Code Execution (RCE)</li>
                <li>Data Theft or Leakage</li>
                <li>Denial of Service (DoS)</li>
                <li>Unauthorized Access</li>
            </ul>
        </div>

        <div class="bg-gray-800 p-6 rounded-lg shadow-lg">
            <h2 class="text-3xl font-bold text-cyan-400 mb-4">How to Prevent SSTI?</h2>
            <ul class="list-disc ml-6 space-y-2">
                <li>Avoid using <code>render_template_string()</code> unless absolutely necessary.</li>
                <li>Sanitize user inputs before processing.</li>
                <li>Use safe rendering functions or escaping mechanisms.</li>
                <li>Implement strong Content Security Policies (CSP).</li>
            </ul>
        </div>

        <div class="bg-gray-800 p-6 rounded-lg shadow-lg">
            <h2 class="text-3xl font-bold text-cyan-400 mb-4">References</h2>
            <ul class="list-disc ml-6 space-y-2">
                <li><a href="https://portswigger.net/web-security/server-side-template-injection" target="_blank" class="text-blue-400 hover:underline">PortSwigger - Server-Side Template Injection</a></li>
                <li><a href="https://cheatsheetseries.owasp.org/cheatsheets/Server_Side_Template_Injection_Prevention_Cheat_Sheet.html" target="_blank" class="text-blue-400 hover:underline">OWASP Cheat Sheet - SSTI</a></li>
                <li><a href="https://jinja.palletsprojects.com/en/latest/" target="_blank" class="text-blue-400 hover:underline">Jinja2 Documentation</a></li>
            </ul>
        </div>
        
    </div>
</body>
</html>
